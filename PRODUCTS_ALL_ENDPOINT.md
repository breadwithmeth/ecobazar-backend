# Новый API эндпоинт для получения всех товаров

## Обзор изменений

Добавлен новый API эндпоинт `GET /api/products/all` для получения всех товаров сразу без пагинации.

## Новая функциональность

### Эндпоинт: `GET /api/products/all`

**Назначение:** Позволяет клиентским приложениям получить полный список товаров без ограничений пагинации.

**Особенности:**
- ✅ Все товары в одном запросе
- ✅ Поддержка всех фильтров (поиск, категория, магазин, цена)
- ✅ Настраиваемая сортировка
- ✅ Информация об остатках на складе
- ✅ Публичный доступ (без токена)

**Параметры запроса:**
- `search` (string): Поиск по названию товара
- `categoryId` (number): Фильтр по категории
- `storeId` (number): Фильтр по магазину  
- `minPrice` (number): Минимальная цена
- `maxPrice` (number): Максимальная цена
- `sortBy` (string): Поле для сортировки (по умолчанию: id)
- `sortOrder` (string): Порядок сортировки: asc/desc (по умолчанию: asc)

**Формат ответа:**
```json
{
  "success": true,
  "data": {
    "products": [
      {
        "id": 1,
        "name": "Органические яблоки",
        "price": 199.99,
        "image": "https://example.com/apple.jpg",
        "store": {
          "id": 1,
          "name": "Эко Маркет",
          "location": "Москва"
        },
        "category": {
          "id": 1,
          "name": "Фрукты"
        },
        "stock": 50,
        "inStock": true,
        "createdAt": "2025-01-21T10:00:00.000Z"
      }
    ],
    "total": 150
  }
}
```

## Модифицированные файлы

### 1. `/src/controllers/productController.ts`
- ✅ Добавлена новая функция `getAllProducts`
- ✅ Логика получения всех товаров без пагинации
- ✅ Сохранены все существующие фильтры и сортировка
- ✅ Добавлена информация об остатках склада

### 2. `/src/routes/product.ts`
- ✅ Добавлен импорт `getAllProducts`
- ✅ Новый роут `GET /all` перед роутом `GET /:id`
- ✅ Публичный доступ (без аутентификации)

### 3. `/API.md`
- ✅ Добавлено описание нового эндпоинта
- ✅ Обновлены примеры использования JavaScript/TypeScript
- ✅ Обновлены примеры cURL команд

## Примеры использования

### JavaScript/TypeScript
```javascript
// Получить все товары
const response = await fetch('/api/products/all');
const data = await response.json();
console.log(`Всего товаров: ${data.data.total}`);

// С фильтрами
const filtered = await fetch('/api/products/all?categoryId=1&search=яблоки&sortBy=price');
const products = await filtered.json();

// В React компоненте
useEffect(() => {
  const loadAllProducts = async () => {
    const response = await fetch('/api/products/all?sortBy=name&sortOrder=asc');
    const data = await response.json();
    setProducts(data.data.products);
  };
  loadAllProducts();
}, []);
```

### cURL
```bash
# Все товары
curl "http://localhost:4000/api/products/all"

# С фильтрами
curl "http://localhost:4000/api/products/all?categoryId=1&search=яблоки"

# С сортировкой
curl "http://localhost:4000/api/products/all?sortBy=price&sortOrder=asc"
```

## Преимущества

### Для клиентских приложений:
1. **Простота использования** - один запрос вместо множества пагинированных
2. **Полный контроль** - клиент сам решает как отображать товары
3. **Локальная фильтрация** - возможность дополнительной фильтрации на клиенте
4. **Кэширование** - можно закэшировать все товары локально

### Для мобильных приложений:
1. **Меньше сетевых запросов** - снижение нагрузки на батарею
2. **Офлайн режим** - возможность работы без интернета
3. **Быстрая навигация** - мгновенный поиск и фильтрация

### Для производительности:
1. **Оптимизированные запросы** - один запрос к БД вместо множества
2. **Bulk операции** - эффективная загрузка остатков склада
3. **Сохранены фильтры** - БД делает только необходимые выборки

## Совместимость

### Обратная совместимость:
- ✅ Существующий эндпоинт `GET /api/products` работает как прежде
- ✅ Пагинация осталась доступной для случаев с большими объемами
- ✅ Все фильтры и сортировка идентичны в обоих эндпоинтах

### Рекомендации использования:
- **`GET /api/products`** - для административных панелей, таблиц с пагинацией
- **`GET /api/products/all`** - для каталогов товаров, мобильных приложений, клиентских фильтров

## Статус
✅ **ЗАВЕРШЕНО** - Новый эндпоинт успешно добавлен и готов к использованию.
